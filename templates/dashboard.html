{% extends 'layout.html' %} {% block head %}
<title>Dashboard</title>
{% endblock %} {% block body %}
<body>
  <div class="container mt-5">
    <h1 class="text-center">Welcome, {{ user.username }}!</h1>
    <h2 class="text-center">Your Form Submissions</h2>

    {% for user_form in user_forms_received %}
    <p><h6>Sender</h6> {{ user_form.name }} </p>
    <a
      href="{{ url_for('view_form', form_id=user_form.id) }}"
      class="btn btn-primary btn-sm"
      >View Transfered Forms</a
    >
    {% endfor %}

    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <ul class="flashes">
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}

    <div class="mb-3">
      <label for="searchInput" class="form-label">Search:</label>
<input
    type="text"
    class="form-control"
    id="searchInput"
    name="search_query"
    oninput="searchForms()"
    placeholder="Enter search keyword"
/>

      <div class="table-responsive">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Name</th>
              <th>User Name</th>
              <th>Phone Number</th>
              <th>Description</th>
              <th>Solution</th>
              <th>Times Stamp</th>
              <th>Transfered To</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for user_form in user_forms %}
            <tr>
              <td>{{ user_form.name }}</td>
              <td>{{ user.username }}</td>
              <td>{{ user_form.phonenumber }}</td>
              <td>{{ user_form.description }}</td>
              <td>{{ user_form.solution }}</td>
              <td>{{ user_form.date_updated }}</td>
              <td>
                {% for user_form in user_forms_sender %}
    {{ user_form.name }} </p>
    
    {% endfor %}
                </td>

              <td>
                <a
                  href="{{ url_for('edit_form', form_id=user_form.id) }}"
                  class="btn btn-primary btn-sm"
                  >Edit</a
                >
                <button
                  class="btn btn-danger btn-sm"
                  onclick="deleteForm('{{ user_form.id }}')"
                >
                  Delete
                </button>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
 
  <script>
    function searchForms() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("searchInput");
        filter = input.value.toUpperCase();
        table = document.querySelector(".table");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            td1 = tr[i].getElementsByTagName("td")[3]; // Adjust index based on the first column to search
            td2 = tr[i].getElementsByTagName("td")[4]; // Adjust index based on the second column to search

            if (td1 && td2) {
                txtValue1 = td1.textContent || td1.innerText;
                txtValue2 = td2.textContent || td2.innerText;

                // Use OR condition to check if the filter matches either column
                if (txtValue1.toUpperCase().indexOf(filter) > -1 || txtValue2.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }
</script>
  
  {% endblock %}
</body>


